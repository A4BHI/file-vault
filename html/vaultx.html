<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="0" />
  <title>Vaultx Dashboard</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    html {
      scroll-behavior: smooth;
    }
    body {
      margin: 0;
      padding: 0;
      background-color: #0a192f;
      
      color: #ccd6f6;
      background-image: 
        radial-gradient(circle at 25% 25%, rgba(37, 109, 133, 0.15) 0%, transparent 60%),
        radial-gradient(circle at 75% 75%, rgba(100, 255, 218, 0.15) 0%, transparent 60%),
        linear-gradient(135deg, rgba(10, 25, 47, 0.8), rgba(17, 34, 64, 0.6));
      background-attachment: fixed;
    }
    
    /* Enhanced link styling */
    a {
      color: #64ffda;
      transition: all 0.3s ease;
    }
    a:hover {
      text-decoration: underline;
      color: #5be8cc;
      text-shadow: 0 0 8px rgba(100, 255, 218, 0.4);
    }
    
    /* Enhanced card styling */
    .card {
      background: linear-gradient(135deg, #112240, #1a2f5a);
      border: 1px solid #233554;
      backdrop-filter: blur(10px);
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }
    .card::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(100, 255, 218, 0.1), transparent);
      transition: left 0.5s ease;
    }
    .card:hover::before {
      left: 100%;
    }
    .card:hover {
      border-color: #64ffda;
      box-shadow: 0 8px 32px rgba(100, 255, 218, 0.1);
      transform: translateY(-5px);
    }
    
    /* Button enhancements */
    .btn-primary {
      background: linear-gradient(135deg, #64ffda, #5be8cc);
      color: #0a192f;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }
    .btn-primary::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: left 0.5s ease;
    }
    .btn-primary:hover::before {
      left: 100%;
    }
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(100, 255, 218, 0.3);
    }
    
    .btn-secondary {
       border: 2px solid #64ffda;
      color: #64ffda;
      background: rgba(100, 255, 218, 0.05);
      transition: all 0.3s ease;
    }
    .btn-secondary:hover {
      background: rgba(100, 255, 218, 0.1);
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(100, 255, 218, 0.2);
    }
    
    /* Header enhancement */
    header {
      backdrop-filter: blur(20px);
      background: rgba(10, 25, 47, 0.9);
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
    }
    
    /* Sidebar styling */
    .sidebar {
      background: linear-gradient(135deg, rgba(10, 25, 47, 0.9), rgba(17, 34, 64, 0.8));
      backdrop-filter: blur(10px);
      border-right: 1px solid #233554;
    }
    
    .sidebar-item {
      transition: all 0.3s ease;
      border-left: 3px solid transparent;
      cursor: pointer;
    }
    
    .sidebar-item:hover {
      background: rgba(100, 255, 218, 0.05);
      border-left-color: #64ffda;
    }
    
    .sidebar-item.active {
      background: rgba(100, 255, 218, 0.1);
      border-left-color: #64ffda;
    }
    
    /* File upload area */
    .upload-area {
      border: 2px dashed #64ffda;
      background: rgba(100, 255, 218, 0.05);
      transition: all 0.3s ease;
    }
    
    .upload-area:hover {
      background: rgba(100, 255, 218, 0.1);
      box-shadow: 0 8px 25px rgba(100, 255, 218, 0.1);
    }
    
    /* Progress bar */
    .progress-bar {
      background: rgba(100, 255, 218, 0.2);
    }
    
    .progress-fill {
      background: linear-gradient(90deg, #64ffda, #5be8cc);
      transition: width 0.5s ease;
    }
    
    /* File list items */
    .file-item {
      border-bottom: 1px solid #233554;
      transition: all 0.3s ease;
    }
    
    .file-item:hover {
      background: rgba(100, 255, 218, 0.05);
    }
    
    /* Status badges */
    .badge {
      font-size: 0.75rem;
      padding: 0.25rem 0.5rem;
      border-radius: 9999px;
    }
    
    .badge-active {
      background: rgba(100, 255, 218, 0.1);
      color: #64ffda;
      border: 1px solid #64ffda;
    }
   
    
    .badge-expired {
      background: rgba(255, 107, 107, 0.1);
      color: #ff6b6b;
      border: 1px solid #ff6b6b;
    }
    
    /* Text glow effect */
    .glow-text {
      text-shadow: 0 0 10px rgba(100, 255, 218, 0.5);
    }
    
    /* Smooth animations */
    @keyframes float {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-10px); }
    }
    .floating {
      animation: float 6s ease-in-out infinite;
    }
    
    /* Chart container */
    .chart-container {
      background: linear-gradient(135deg, #112240, #1a2f5a);
      border: 1px solid #233554;
    }
    
    /* Content sections */
    .content-section {
      display: none;
    }
    
    .content-section.active {
      display: block;
    }
    
    /* Responsive adjustments */
    @media (max-width: 768px) {
      .sidebar {
        position: fixed;
        z-index: 40;
        left: -100%;
        transition: left 0.3s ease;
      }
      
      .sidebar.open {
        left: 0;
      }
      
      .mobile-menu-btn {
        display: block;
      }
    }
    .description {
            color: #7f8c8d;
            margin-bottom: 30px;
            line-height: 1.6;
        }
        
        .upload-container {
            border: 3px dashed #3498db;
            border-radius: 12px;
            padding: 40px 20px;
            margin-bottom: 30px;
            transition: all 0.3s ease;
            background: rgba(236, 240, 241, 0.5);
            cursor: pointer;
        }
        
        .upload-container:hover {
            background: rgba(236, 240, 241, 0.8);
            border-color: #2980b9;
        }
        
        .upload-container.dragover {
            background: rgba(52, 152, 219, 0.2);
            border-color: #2c3e50;
            transform: scale(1.02);
        }
        
        .upload-icon {
            font-size: 60px;
            color: #3498db;
            margin-bottom: 15px;
        }
        
        .upload-text {
            color: #34495e;
            margin-bottom: 20px;
        }
        
        .browse-btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 50px;
            font-size: 16px;
            cursor: pointer;
            transition: background 0.3s;
            font-weight: 600;
        }
        
        .browse-btn:hover {
            background: #2980b9;
        }
        
        #file-input {
            display: none;
        }
        
        .file-info {
            text-align: left;
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .file-info h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #ecf0f1;
        }
        
        .file-details {
            margin-top: 10px;
        }
        
        .file-details p {
            margin: 8px 0;
            color: #34495e;
        }
        
        .encryption-options {
            display: none;
            margin: 25px 0;
            text-align: left;
        }
        
        .option-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border: 2px solid transparent;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .option-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
        }
        
        .option-card.selected {
            border-color: #3498db;
            background: rgba(52, 152, 219, 0.05);
        }
        
        .option-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .option-icon {
            font-size: 24px;
            margin-right: 15px;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            color: white;
        }
        
        .frontend-icon {
            background: #2ecc71;
        }
        
        .backend-icon {
            background: #e74c3c;
        }
        
        .option-title {
            font-size: 18px;
            font-weight: 600;
            color: #2c3e50;
        }
        
        .option-description {
            color: #7f8c8d;
            margin-left: 55px;
            line-height: 1.5;
        }
        
        .progress-container {
            height: 10px;
            background: #ecf0f1;
            border-radius: 5px;
            margin: 15px 0;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background: #2ecc71;
            width: 0%;
            transition: width 0.4s ease;
        }
        
        .upload-btn {
            background: #2ecc71;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 50px;
            font-size: 16px;
            cursor: pointer;
            transition: background 0.3s;
            font-weight: 600;
            width: 100%;
            margin-top: 10px;
            display: none;
        }
        
        .upload-btn:hover {
            background: #27ae60;
        }
        
        .upload-btn:disabled {
            background: #95a5a6;
            cursor: not-allowed;
        }
        
        .status-message {
            margin-top: 20px;
            padding: 12px;
            border-radius: 8px;
            text-align: center;
            font-weight: 500;
        }
        
        .success {
            background: rgba(46, 204, 113, 0.2);
            color: #27ae60;
        }
        
        .error {
            background: rgba(231, 76, 60, 0.2);
            color: #c0392b;
        }
        
        .info {
            background: rgba(52, 152, 219, 0.2);
            color: #2980b9;
        }
        
        .hidden {
            display: none;
        }
        
        .password-section {
            margin-top: 15px;
            text-align: left;
        }
        
        .password-input {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin-top: 5px;
            font-size: 16px;
        }
        
        .password-note {
            font-size: 14px;
            color: #7f8c8d;
            margin-top: 5px;
        }

        #Delete{
          border: 2px solid red;
        }
        
.file-info {
    text-align: left;
    background: linear-gradient(135deg, #112240, #1a2f5a);
    border-radius: 8px;
    padding: 20px;
    margin-bottom: 20px;
    box-shadow: 0 4px 6px rgba(100, 255, 218, 0.08);
    border: 1px solid #233554;
    color: #ccd6f6;
}

.file-info h3 {
    color: #64ffda;
    margin-bottom: 15px;
    padding-bottom: 10px;
    border-bottom: 1px solid #233554;
}

.file-details p {
    margin: 8px 0;
    color: #8892b0;
}

.badge-processing {
    background: rgba(255, 193, 7, 0.1);
    color: #ffc107;
    border: 1px solid #ffc107;
}

.sortable {
    user-select: none;
}

.sortable:hover {
    background: rgba(100, 255, 218, 0.05);
}

.file-item {
    transition: all 0.3s ease;
}

.file-action {
    transition: all 0.2s ease;
}

.file-action:hover {
    transform: scale(1.1);
}


#filesLoading, #filesEmpty {
    min-height: 200px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
}

.filter-btn.active {
    background: linear-gradient(135deg, #64ffda, #5be8cc);
    color: #0a192f;
}

/* security cards */
.glow-card {
  box-shadow: 0 0 15px rgba(100, 255, 218, 0.15);
  transition: all 0.6s ease;
}
.glow-card:hover {
  box-shadow: 0 0 25px rgba(100, 255, 218, 0.35);
  transform: translateY(-3px);
}

/* Smooth fade animations */
@keyframes fadeInOut {
  0% { opacity: 0; transform: translateY(10px); }
  10%, 90% { opacity: 1; transform: translateY(0); }
  100% { opacity: 0; transform: translateY(-10px); }
}


/* Make table grid lines subtle but visible */
table {
  border-spacing: 0;
}

th, td {
  border-right: 1px solid rgba(35, 53, 84, 0.4);
}
th:last-child, td:last-child {
  border-right: none;
}

/* Table rows */
tbody tr {
  border-bottom: 1px solid rgba(35, 53, 84, 0.5);
  transition: all 0.25s ease;
}

/* Hover highlight */
tbody tr:hover {
  background-color: rgba(100, 255, 218, 0.04);
  transform: translateX(2px);
}

/* Table headers */
thead th {
  font-size: 0.75rem;
  letter-spacing: 1px;
}

/* Smooth scrollbar (for overflow) */
#filesTable::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}
#filesTable::-webkit-scrollbar-thumb {
  background-color: rgba(100, 255, 218, 0.2);
  border-radius: 8px;
}
#filesTable::-webkit-scrollbar-thumb:hover {
  background-color: rgba(100, 255, 218, 0.4);
}






@media (max-width: 768px) {
  .sidebar {
    position: fixed;
    z-index: 40;
    left: -100%;
    transition: left 0.3s ease;
  }

  .sidebar.open {
    left: 0;
  }

  .mobile-menu-btn {
    display: block;
  }
}

  </style>
</head>
<body>
  <div class="flex h-screen overflow-hidden">
    <!-- Sidebar -->
    <div class="sidebar w-64 flex-shrink-0 md:block">
      <div class="p-4 border-b border-[#233554]">
        <div class="flex items-center gap-3">
          <div class="w-8 h-8 bg-gradient-to-br flex items-center justify-center">
            <span><img src="logo.png"></span>
          </div>
          <span class="font-semibold text-lg text-[#64ffda] glow-text">Vaultx</span>
        </div>
      </div>
      
      <div class="p-4">
        <div class="flex items-center gap-3 mb-6 p-3 rounded-lg bg-[#112240]">
          <div class="w-10 h-10 rounded-full bg-gradient-to-br from-[#64ffda] to-[#5be8cc] flex items-center justify-center">
            <span class="text-[#0a192f] font-bold" id="pic">JD</span>
          </div>
          <div>
            <p class="font-medium" id="user">Unknown User</p>
            <p class="text-xs text-[#64ffda]" id="status">Unknown</p>
          </div>
        </div>
        
        <nav class="space-y-1">
          <a data-target="dashboard" class="sidebar-item active flex items-center gap-3 p-3 rounded-lg">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
            </svg>
            Dashboard
          </a>
          
          <a data-target="upload" class="sidebar-item flex items-center gap-3 p-3 rounded-lg">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10" />
            </svg>
            Upload Files
          </a>
          
          <a data-target="files" class="sidebar-item flex items-center gap-3 p-3 rounded-lg">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
            </svg>
            My Files
          </a>


          <a data-target="about" class="sidebar-item flex items-center gap-3 p-3 rounded-lg">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
              d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
          About / Docs
        </a>
        </nav>
      </div>
      
      <div class="p-4 border-t border-[#233554] mt-auto">
        <button class="btn-secondary w-full px-4 py-2 rounded-md flex items-center justify-center gap-2" id="logout">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
          </svg>
          Logout
        </button>
      </div>

      <div class="p-4 border-t border-[#233554] mt-auto">
        <button class="btn-secondary w-full px-4 py-2 rounded-md flex items-center justify-center gap-2" id="Delete">
          <!-- <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"> -->
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
          </svg>
          Delete Account
        </button>
      </div>
    </div>
     
    
    
    <!-- Mobile sidebar toggle -->
    <button class="mobile-menu-btn fixed bottom-4 right-4 z-50 md:hidden w-12 h-12 bg-[#64ffda] text-[#0a192f] rounded-full flex items-center justify-center shadow-lg">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
      </svg>
    </button>
    
    <!-- Main content -->
    <div class="flex-1 flex flex-col overflow-hidden">
      <!-- Top header -->
      <header class="flex justify-between items-center px-6 py-4 border-b border-[#233554] sticky top-0 z-30">
        <div class="flex items-center gap-4">
          <h1 class="font-bold text-xl text-[#64ffda] glow-text" id="page-title">Dashboard</h1>
        </div>
        
        <div class="flex items-center gap-4">
          <div class="relative">
            <div class="w-8 h-8 rounded-full flex items-center justify-center cursor-pointer">
              
            </div>
           
          </div>
          
         
        </div>
      </header>
      
      <!-- Content area -->
      <div class="flex-1 overflow-y-auto p-6">
        <!-- Dashboard Section -->
         
        <div id="dashboard" class="content-section active">


          <div class="grid grid-cols-1 md:grid-cols- gap-6 mb-6">

<!-- SECURITY TIPS CARD -->
<div class="card p-6 rounded-xl mt-6 relative overflow-hidden" id="securityCard">
  <h3 class="font-medium mb-4 flex items-center gap-2 text-[#64ffda]">
    <i class="fas fa-shield-alt text-[#64ffda]"></i> Security Tips
  </h3>
  
  <div class="relative h-32 flex items-center justify-center overflow-hidden">
    <div id="securityTipCard" 
         class="absolute inset-0 flex flex-col items-center justify-center 
                border border-[#64ffda]/40 bg-[#0a192f]/70 
                p-4 rounded-lg shadow-md text-[#ccd6f6] text-center glow-card opacity-0">
      <i id="securityIcon" class="fas fa-lock text-[#64ffda] text-2xl mb-3 block"></i>
      <p id="securityTip" class="text-[#8892b0] italic text-base"></p>
    </div>
  </div>
</div>
           <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
  <!-- Storage Used -->
  <div class="card p-6 rounded-xl flex flex-col items-center md:items-start">
    <div class="flex items-center justify-between w-full mb-4">
      <h3 class="font-medium">Storage Used</h3>
    </div>
    <span class="text-sm bg-[#64ffda] text-[#0a192f] px-3 py-1 rounded-full font-semibold">0  GB</span>
  </div>

  <!-- Files Uploaded -->
  <div class="card p-6 rounded-xl flex flex-col items-center md:items-start">
    <div class="flex items-center justify-between w-full mb-4">
      <h3 class="font-medium">Files Uploaded</h3>
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-[#64ffda]" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
      </svg>
    </div>
    <p class="text-3xl font-bold">0</p>
  </div>
</div>

            
          </div>
          
          <div class="grid grid-cols-1 md:grid-cols-1 gap-6 mb-6">
            
            
            <div class="card p-6 rounded-xl">
              <h3 class="font-medium mb-4">Quick Actions</h3>
                <button class="btn-secondary w-full px-4 py-3 rounded-lg flex flex-col items-center justify-center gap-2" onclick="showUploadSection()">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10" />
                  </svg>
                  <span>Upload</span>
                </button><br>
                

              
            </div>
          </div>
<div class="card p-6 rounded-xl mt-6">
  <h3 class="font-medium mb-4">Storage Overview</h3>
  <div class="flex justify-center">
    <div style="width:350px; height:350px;">
      <canvas id="storageChart"></canvas>
    </div>
  </div>
  <div class="text-center mt-4 text-[#8892b0]">
    <span id="storageText" class="text-[#64ffda] text-xl font-bold">25%</span> used
  </div>
</div>




        </div>
        
        <!-- Upload Files Section -->
<div id="upload" class="content-section">
  <div class="card p-11 rounded-2xl mb-11">
    <h2 class="font-bold text-xl mb-6">Secure File Upload</h2>

        <!-- üîπ ENCRYPTION INFO CARDS -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-10">
      <!-- Frontend Encryption Info -->
      <div
        class="card p-6 rounded-xl border border-[#233554] bg-gradient-to-br from-[#0b223d] to-[#132b4c] hover:border-[#64ffda] hover:shadow-[0_0_20px_rgba(100,255,218,0.1)] transition-all duration-300">
        <div class="flex items-center gap-4 mb-3">
          <div class="w-12 h-12 rounded-full bg-[#2ecc71]/20 flex items-center justify-center text-[#2ecc71]">
            <i class="fas fa-lock text-xl"></i>
          </div>
          <h3 class="text-lg font-semibold text-[#64ffda]">Frontend Encryption</h3>
        </div>
        <p class="text-[#a8b2d1] leading-relaxed text-sm">
          Your file is encrypted <strong>inside your browser</strong> before upload.
          This ensures the server never sees your unencrypted data ‚Äî full client-side security.
        </p>
      </div>

      <!-- Backend Encryption Info -->
      <div
        class="card p-6 rounded-xl border border-[#233554] bg-gradient-to-br from-[#0b223d] to-[#132b4c] hover:border-[#64ffda] hover:shadow-[0_0_20px_rgba(100,255,218,0.1)] transition-all duration-300">
        <div class="flex items-center gap-4 mb-3">
          <div class="w-12 h-12 rounded-full bg-[#e74c3c]/20 flex items-center justify-center text-[#e74c3c]">
            <i class="fas fa-server text-xl"></i>
          </div>
          <h3 class="text-lg font-semibold text-[#64ffda]">Backend Encryption</h3>
        </div>
        <p class="text-[#a8b2d1] leading-relaxed text-sm">
          The file is uploaded first and then encrypted securely <strong>on the server</strong>.
          Suitable for users who trust the backend to handle encryption.
        </p>
      </div>
    </div>

    <div class="upload-area p-8 rounded-lg text-center mb-6" id="dropArea">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 mx-auto text-[#64ffda] mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
          d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10" />
      </svg>
      <p class="mb-2">Drag & drop files here or click to browse</p>
      <input type="file" id="fileInput" style="display:none;">
      <button class="btn-primary px-4 py-2 rounded-md" id="browseBtn">Browse Files</button>

      <!-- FILE INFO -->
      <div class="file-info hidden" id="file-info">
        <h3>Selected File</h3>
        <div class="file-details">
          <p><strong>Name:</strong> <span id="file-name"></span></p>
          <p><strong>Size:</strong> <span id="file-size"></span></p>
          <p><strong>Type:</strong> <span id="file-type"></span></p>
        </div>

        <!-- ENCRYPTION OPTIONS -->
        <div class="encryption-options" id="encryption-options">
          <h3>Choose Encryption Method</h3>
          <div class="option-card" id="frontend-option">
            <div class="option-header">
              <div class="option-icon frontend-icon">
                <i class="fas fa-lock"></i>
              </div>
              <div class="option-title">Frontend Encryption</div>
            </div>
            <div class="option-description">
              File is encrypted in your browser before being sent to the server.
            </div>
          </div>
          <div class="option-card" id="backend-option">
            <div class="option-header">
              <div class="option-icon backend-icon">
                <i class="fas fa-server"></i>
              </div>
              <div class="option-title">Backend Encryption</div>
            </div>
            <div class="option-description">
              File is sent to the server and encrypted there.
            </div>
          </div>
        </div>
      </div>

      <div class="progress-container">
        <div class="progress-bar" id="progress-bar"></div>
      </div>
      <button class="upload-btn" id="upload-btn" disabled>Upload & Encrypt File</button>
    </div>

    <div class="status-message hidden" id="status-message"></div>
  </div>
</div>

<!-- PASSWORD MODAL -->
<div id="passwordModal"
  class="fixed inset-0 bg-black bg-opacity-60 hidden items-center justify-center z-50 transition-opacity duration-300">
  <div
    class="bg-[#112240] text-white rounded-xl p-6 w-[90%] max-w-sm shadow-xl border border-[#64ffda]/30 backdrop-blur-md">
    <h2 class="text-lg font-bold mb-4 text-center">Enter Encryption Password</h2>
    <input type="password" id="passwordInputModal" placeholder="Enter your password"
      class="w-full mb-4 bg-[#0a192f] border border-[#64ffda] rounded-md p-2 placeholder-gray-400 text-white focus:ring-2 focus:ring-[#64ffda]">
    <div class="flex justify-end gap-3">
      <button id="cancelPassword" class="px-4 py-2 rounded-md bg-gray-600 hover:bg-gray-700">Cancel</button>
      <button id="confirmPassword"
        class="px-4 py-2 rounded-md bg-[#64ffda] text-[#0a192f] font-bold hover:bg-[#52e6c4]">Confirm</button>
    </div>
  </div>
</div>
        <!--My Files Section-->
        <!-- My Files Section -->
<div id="files" class="content-section ">
  <div class="card p-6 rounded-xl mb-6 h-[600px]" id="test">
    <div class="flex flex-col md:flex-row md:items-center justify-between mb-6">
      <h2 class="font-bold text-xl mb-4 md:mb-0">My Files</h2>
      
     <div class="flex gap-3">
  <button id="quickUpload" class="btn-primary px-4 py-2 rounded-md flex items-center gap-2" onclick="showUploadSection()">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
    </svg>
    Upload File
  </button>
</div>

    </div>
    
    <div class="mb-6">
      <div class="flex gap-2 overflow-x-auto pb-2" id="fileFilters">
      
      </div>
    </div>
    
   
    <!-- Files Table -->
    <!-- Files Table -->
<!-- FILES TABLE (dynamic) -->
<div id="filesTable" class="overflow-x-auto max-h-[400px] rounded-xl border border-[#233554] shadow-md">
  <table class="w-full border-collapse">
    <thead class="bg-[#112240] sticky top-0 z-10">
      <tr class="text-[#64ffda] uppercase text-xs tracking-wider border-b border-[#233554]">
        <th class="text-left py-3 px-4 font-semibold cursor-pointer sortable" data-sort="name">File Name</th>
        <th class="text-left py-3 px-4 font-semibold cursor-pointer sortable" data-sort="size">Size</th>
        <th class="text-left py-3 px-4 font-semibold cursor-pointer sortable" data-sort="type">Type</th>
        <th class="text-left py-3 px-4 font-semibold">Actions</th>
      </tr>
    </thead>
    <tbody id="filesList" class="text-[#ccd6f6] text-sm">
      <!-- Your JS dynamically inserts rows here -->
    </tbody>
  </table>
</div>

    
    <!-- Pagination -->
    <div class="flex justify-between items-center mt-6 hidden" id="filesPagination">
      <p class="text-sm text-[#8892b0]" id="filesCount">Showing 0 of 0 files</p>
    
    </div>
  </div>
</div>



<!-- ABOUT / DOCUMENTATION SECTION -->
<div id="about" class="content-section hidden">
  <div class="card p-10 rounded-2xl mb-11">
    <h2 class="font-bold text-2xl mb-8 text-[#64ffda] glow-text text-center">Vaultx Documentation</h2>

    <p class="text-[#a8b2d1] text-center mb-10 max-w-3xl mx-auto leading-relaxed">
      Learn how to use <strong>Vaultx</strong> ‚Äî a secure, privacy-focused platform that encrypts and stores your files safely.
      Below are guides and explanations of features, encryption methods, and technologies used.
    </p>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-10">
      <!-- Section 1 -->
      <div class="card p-6 rounded-xl border border-[#233554] bg-gradient-to-br from-[#0b223d] to-[#132b4c] hover:border-[#64ffda] transition-all duration-300">
        <h3 class="text-[#64ffda] font-semibold mb-2">Frontend Encryption</h3>
        <p class="text-[#a8b2d1] text-sm leading-relaxed">
          Encrypts files directly in your browser using <strong>AES-GCM</strong> and <strong>PBKDF2</strong> before upload.  
          The server never sees your unencrypted data.
        </p>
      </div>

      <!-- Section 2 -->
      <div class="card p-6 rounded-xl border border-[#233554] bg-gradient-to-br from-[#0b223d] to-[#132b4c] hover:border-[#64ffda] transition-all duration-300">
        <h3 class="text-[#64ffda] font-semibold mb-2">Backend Encryption</h3>
        <p class="text-[#a8b2d1] text-sm leading-relaxed">
          Files are securely transmitted to the backend where they‚Äôre encrypted server-side with the user‚Äôs password and stored in the database.
        </p>
      </div>

      <!-- Section 3 -->
      <div class="card p-6 rounded-xl border border-[#233554] bg-gradient-to-br from-[#0b223d] to-[#132b4c] hover:border-[#64ffda] transition-all duration-300">
        <h3 class="text-[#64ffda] font-semibold mb-2">Technologies Used</h3>
        <ul class="text-[#a8b2d1] text-sm list-disc pl-5">
          <li>Go (Backend API)</li>
          <li>JavaScript + Tailwind (Frontend)</li>
          <li>MySQL Database</li>
          <li>Crypto APIs for AES-GCM Encryption</li>
          <li>Secure File Upload with FormData</li>
        </ul>
      </div>

      <!-- Section 4 -->
      <div class="card p-6 rounded-xl border border-[#233554] bg-gradient-to-br from-[#0b223d] to-[#132b4c] hover:border-[#64ffda] transition-all duration-300">
        <h3 class="text-[#64ffda] font-semibold mb-2">Tutorial</h3>
        <ol class="text-[#a8b2d1] text-sm list-decimal pl-5 leading-relaxed">
          <li>Select an encryption type (Frontend/Backend)</li>
          <li>Choose your file or drag it into the upload box</li>
          <li>Enter a password when prompted</li>
          <li>Wait for encryption and upload to complete</li>
          <li>View and download files from the ‚ÄúMy Files‚Äù page</li>
        </ol>
      </div>
    </div>

    <div class="text-center text-[#8892b0]">
      <p class="text-sm">Developed by <span class="text-[#64ffda] font-medium">Vaultx Team</span></p>
      <p class="text-xs mt-2 italic text-[#5be8cc]">"Security isn‚Äôt optional ‚Äî it‚Äôs built in."</p>
    </div>
  </div>
</div>


      
    
  <div id="decryptModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
  <div class="bg-[#112240] text-white rounded-xl p-6 w-[90%] max-w-sm shadow-xl">
    <h2 class="text-lg font-bold mb-4 text-center">Decrypt and Download your File</h2>

    <label class="block mb-2 text-sm">Select Decryption Mode:</label>
    <select id="encryptionMode" class="w-full mb-4 bg-[#0a192f] border border-[#64ffda] rounded-md p-2">
      <option value="frontend">Frontend Decryption</option>
      <option value="backend">Backend Decryption</option>
    </select>

    <label class="block mb-2 text-sm">Enter your password:</label>
    <input type="password" id="decryptPassword" placeholder="Enter your password"
      class="w-full mb-4 bg-[#0a192f] border border-[#64ffda] rounded-md p-2 placeholder-gray-400 text-white">

    <div class="flex justify-end gap-3">
      <button id="cancelDecrypt" class="px-4 py-2 rounded-md bg-gray-600 hover:bg-gray-700">Cancel</button>
      <button id="confirmDecrypt" class="px-4 py-2 rounded-md bg-[#64ffda] text-[#0a192f] font-bold hover:bg-[#52e6c4]">
        Decrypt & Download
      </button>
    </div>
  </div>
</div>

  <div id="deleteModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
  <div class="bg-[#112240] text-white rounded-xl p-6 w-[90%] max-w-sm shadow-xl">
    <h2 class="text-lg font-bold mb-4 text-center">Delete Your Account?<br><b>All Files Will Be Deleted Permanently</b></h2>

    

    <label class="block mb-2 text-sm">Enter your password:</label>
    <input type="password" id="deletePassword" placeholder="Enter your password"
      class="w-full mb-4 bg-[#0a192f] border border-[#64ffda] rounded-md p-2 placeholder-gray-400 text-white">

    <div class="flex justify-end gap-3">
      <button id="cancelDelete" class="px-4 py-2 rounded-md bg-gray-600 hover:bg-gray-700">Cancel</button>
      <button id="confirmDelete" class="px-4 py-2 rounded-md bg-[#64ffda] text-[#0a192f] font-bold hover:bg-[#52e6c4]">
        Delete
      </button>
    </div>
  </div>
</div>

  <div id="incorrectModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
  <div class="bg-[#112240] text-white rounded-xl p-6 w-[90%] max-w-sm shadow-xl">
    <h2 class="text-lg font-bold mb-4 text-center">Incorrect Password :(</h2>
    <div class="flex justify-end gap-3">
      <button id="OK" class="px-4 py-2 rounded-md bg-[#64ffda] text-[#0a192f] font-bold hover:bg-[#52e6c4]">
        OK
      </button>
    </div>
  </div>
</div>


  <div id="accdeletedModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
  <div class="bg-[#112240] text-white rounded-xl p-6 w-[90%] max-w-sm shadow-xl">
    <h2 class="text-lg font-bold mb-4 text-center">Account Deleted successfully :) </h2>
    <div class="flex justify-end gap-3">
      <button id="back" class="px-4 py-2 rounded-md bg-[#64ffda] text-[#0a192f] font-bold hover:bg-[#52e6c4]">
        OK
      </button>
    </div>
  </div>
</div>

  <div id="confirmModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
  <div class="bg-[#112240] text-white rounded-xl p-6 w-[90%] max-w-sm shadow-xl">
    <h2 class="text-lg font-bold mb-4 text-center">Are you sure you want to delete the file?<b> This action cannot be undone.</b></h2>

    

   
    <div class="flex justify-end gap-3">
      <button id="cancelConfirm" class="px-4 py-2 rounded-md bg-gray-600 hover:bg-gray-700">Cancel</button>
      <button id="confirm" class="px-4 py-2 rounded-md bg-[#64ffda] text-[#0a192f] font-bold hover:bg-[#52e6c4]">
      Confirm
      </button>
    </div>
  </div>
</div>

<script>

document.querySelector('.mobile-menu-btn').addEventListener('click', function() {
  document.querySelector('.sidebar').classList.toggle('open');
  alert(1)
});



//pie chart
const ctx = document.getElementById('storageChart').getContext('2d');
const usedStorage = 25; // % used
const freeStorage = 100 - usedStorage;

new Chart(ctx, {
  type: 'doughnut',
  data: {
    labels: ['Used', 'Free'],
    datasets: [{
      data: [usedStorage, freeStorage],
      backgroundColor: ['#64ffda', '#1a2f5a'],
      borderWidth: 0
    }]
  },
  options: {
    responsive: true,
    maintainAspectRatio: false, // prevent auto-resizing
    plugins: {
      legend: {
        display: true,
        labels: { color: '#ccd6f6', boxWidth: 12, padding: 10 }
      },
    },
    cutout: '75%' // makes inner circle smaller = thinner ring
  }
});

document.getElementById("storageText").textContent = usedStorage + "%";
//security cards


const tips = [
  { text: "Use strong, unique passwords for encryption and login.", icon: "fa-key" },
  { text: "Frontend encryption ensures your files never leave your browser unprotected.", icon: "fa-lock" },
  { text: "Log out when using Vaultx on shared or public devices.", icon: "fa-sign-out-alt" },
  { text: "Avoid uploading files over unsecured public Wi-Fi.", icon: "fa-wifi" },
  { text: "Never reuse your encryption password elsewhere.", icon: "fa-user-shield" }
];

let tipIndex = 0;
const tipText = document.getElementById("securityTip");
const tipIcon = document.getElementById("securityIcon");
const tipCard = document.getElementById("securityTipCard");

function showNextTip() {
  const tip = tips[tipIndex];
  tipText.textContent = tip.text;
  tipIcon.className = `fas ${tip.icon} text-[#64ffda] text-2xl mb-3 block`;

  // trigger fade animation
  tipCard.style.animation = "none";
  void tipCard.offsetWidth; // reset animation
  tipCard.style.animation = "fadeInOut 4s ease-in-out forwards";

  tipIndex = (tipIndex + 1) % tips.length;
}

showNextTip();
setInterval(showNextTip, 4000); // new tip every 6s

//pie chart end

  document.getElementById("cancelConfirm").addEventListener("click",() =>{
      document.getElementById('confirmModal').classList.add('hidden')  
    })

  window.addEventListener("load",async () =>{
    try{
       let response = await fetch("/verify-jwt",{
      method:"GET",
      credentials:"include"
      })
    if(!response.ok){
      window.location.replace("/index.html")
        return
    }

    let res=await response.json()
    if(!res.Valid){
        window.location.replace("/index.html")
        return
    }
    document.getElementById("user").innerHTML=res.Username
    document.getElementById("status").innerHTML="Logged-in"
    document.getElementById("pic").innerHTML=res.Username.slice(0,2)
    console.log(res)

    }catch(error){ console.error("JWT verify failed:", error);}
   

  })
    // Mobile sidebar toggle
    document.querySelector('.mobile-menu-btn').addEventListener('click', function() {
      document.querySelector('.sidebar').classList.toggle('open');
    });

    // Sidebar navigation
    const sidebarItems = document.querySelectorAll('.sidebar-item');
    const contentSections = document.querySelectorAll('.content-section');
    const pageTitle = document.getElementById('page-title');

    sidebarItems.forEach(item => {
      item.addEventListener('click', function() {
        const target = this.getAttribute('data-target');
        
        // Update active sidebar item
        sidebarItems.forEach(i => i.classList.remove('active'));
        this.classList.add('active');
        
        // Show corresponding content section
        contentSections.forEach(section => {
          section.classList.remove('active');
          if (section.id === target) {
            section.classList.add('active');
            pageTitle.textContent = this.textContent.trim();
          }
        });
        
        // Close mobile sidebar after selection
        if (window.innerWidth < 768) {
          document.querySelector('.sidebar').classList.remove('open');
        }
      });
    });

    // Settings tabs (basic implementation)
    const settingsTabs = document.querySelectorAll('.settings-tab');
    settingsTabs.forEach((tab, index) => {
      tab.addEventListener('click', function() {
        settingsTabs.forEach(t => t.classList.remove('bg-[#112240]', 'text-[#64ffda]'));
        this.classList.add('bg-[#112240]', 'text-[#64ffda]');
      });
    });


document.addEventListener('DOMContentLoaded', function () {
  const dropArea = document.getElementById('dropArea');
  const fileInput = document.getElementById('fileInput');
  const browseBtn = document.getElementById('browseBtn');
  const fileInfo = document.getElementById('file-info');
  const fileName = document.getElementById('file-name');
  const fileSize = document.getElementById('file-size');
  const fileType = document.getElementById('file-type');
  const encryptionOptions = document.getElementById('encryption-options');
  const frontendOption = document.getElementById('frontend-option');
  const backendOption = document.getElementById('backend-option');
  const progressBar = document.getElementById('progress-bar');
  const uploadBtn = document.getElementById('upload-btn');
  const statusMessage = document.getElementById('status-message');

  const passwordModal = document.getElementById('passwordModal');
  const passwordInputModal = document.getElementById('passwordInputModal');
  const cancelPassword = document.getElementById('cancelPassword');
  const confirmPassword = document.getElementById('confirmPassword');

  let selectedFile = null;
  let selectedEncryptionType = null;

  // Trigger file input
  browseBtn.addEventListener('click', (e) => {
    e.stopPropagation();
    fileInput.click();
  });

  // Handle file input
  fileInput.addEventListener('change', function () {
    if (this.files.length > 0) {
      selectedFile = this.files[0];
      displayFileInfo(selectedFile);
    }
  });

  // Drag & Drop
  ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(ev => {
    dropArea.addEventListener(ev, preventDefaults, false);
  });
  function preventDefaults(e) { e.preventDefault(); e.stopPropagation(); }

  ['dragenter', 'dragover'].forEach(ev => dropArea.addEventListener(ev, () => dropArea.classList.add('dragover'), false));
  ['dragleave', 'drop'].forEach(ev => dropArea.addEventListener(ev, () => dropArea.classList.remove('dragover'), false));

  dropArea.addEventListener('drop', (e) => {
    const dt = e.dataTransfer;
    const files = dt.files;
    if (files.length > 0) {
      selectedFile = files[0];
      displayFileInfo(selectedFile);
    }
  });

  function displayFileInfo(file) {
    fileName.textContent = file.name;
    fileSize.textContent = formatFileSize(file.size);
    fileType.textContent = file.type || 'Unknown';
    fileInfo.classList.remove('hidden');
    encryptionOptions.style.display = 'block';
    uploadBtn.style.display = 'block';
    uploadBtn.disabled = true;
    progressBar.style.width = '0%';
    statusMessage.classList.add('hidden');
    resetEncryptionSelection();
  }

  function formatFileSize(bytes) {
    if (bytes === 0) return '0 Bytes';
    const k = 1024;
    const sizes = ['Bytes', 'KB', 'MB', 'GB'];
    const i = Math.floor(Math.log(bytes) / Math.log(k));
    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
  }

  frontendOption.addEventListener('click', () => selectEncryptionOption('frontend'));
  backendOption.addEventListener('click', () => selectEncryptionOption('backend'));

  function selectEncryptionOption(type) {
    resetEncryptionSelection();
    selectedEncryptionType = type;
    (type === 'frontend' ? frontendOption : backendOption).classList.add('selected');
    uploadBtn.disabled = false;
  }

  function resetEncryptionSelection() {
    frontendOption.classList.remove('selected');
    backendOption.classList.remove('selected');
    selectedEncryptionType = null;
    uploadBtn.disabled = true;
  }

  // Show modal on Upload click
  uploadBtn.addEventListener('click', function () {
    if (!selectedFile || !selectedEncryptionType) return;
    passwordModal.classList.remove('hidden');
    passwordModal.classList.add('flex');
    passwordInputModal.value = '';
  });

  cancelPassword.addEventListener('click', () => {
    passwordModal.classList.add('hidden');
    passwordModal.classList.remove('flex');
  });

  confirmPassword.addEventListener('click', async () => {
    const password = passwordInputModal.value.trim();
    if (password.length < 4) {
       document.getElementById('incorrectModal').classList.remove('hidden');
  document.getElementById('incorrectModal').classList.add('flex');
    return;
    }
    passwordModal.classList.add('hidden');
    passwordModal.classList.remove('flex');
    await startUploadWithPassword(password);
  });

  async function startUploadWithPassword(password) {
    uploadBtn.disabled = true;
    statusMessage.classList.remove('hidden');
    statusMessage.textContent = selectedEncryptionType === 'frontend'
      ? 'Encrypting file in your browser...'
      : 'Sending file to server for encryption...';
    statusMessage.classList.remove('error', 'success');
    statusMessage.classList.add('info');

    simulateEncryptionAndUpload(password);
  }

  function simulateEncryptionAndUpload(password) {
    let width = 0;
    const interval = setInterval(() => {
      if (width >= 100) {
        clearInterval(interval);
        completeUpload(password);
      } else {
        width += 2;
        progressBar.style.width = width + '%';
      }
    }, 100);
  }

  async function completeUpload(password) {
    let message = '';
       let formdata=new FormData()
         formdata.append("password",password)
      try{
             let response=await fetch("/Validatepass",{
              method:"POST",
              body:formdata
             })

             let data =await  response.text()
             reply=data
             console.log(data)
         }catch(error){
           console.log(error)
         }

         if(reply=="Pass"){
             if (selectedEncryptionType === 'frontend') {
               const fileInput = document.getElementById('fileInput');
               if (!fileInput.files.length) {
                 alert('Please select a file first');
                 return;
               }

               const file = fileInput.files[0];
               let saltB64;
               let salt;
               try{ 
                 const saltRes = await fetch('/get-salt',{
                   method:"GET"
                 })
                 saltB64 = await saltRes.text();
                 console.log("Salt from the backend",saltB64)
               }catch(error){
                 console.log(error)
               }
              
               salt = Uint8Array.from(atob(saltB64), c => c.charCodeAt(0));
               console.log(salt)
               
               const enc = new TextEncoder();
               const baseKey = await crypto.subtle.importKey(
                 'raw',
                 enc.encode(password),
                 { name: 'PBKDF2' },
                 false,
                 ['deriveKey']
               );

               const masterKey = await crypto.subtle.deriveKey(
                 {
                   name: 'PBKDF2',
                   salt: salt,
                   iterations: 200000,
                   hash: 'SHA-256'
                 },
                 baseKey,
                 { name: 'AES-GCM', length: 256 },
                 false,
                 ['encrypt', 'decrypt']
               );

               const rawKey = crypto.getRandomValues(new Uint8Array(32));
               const fileIV = crypto.getRandomValues(new Uint8Array(12));
               const fileBuffer = await file.arrayBuffer();

               const fileKey = await crypto.subtle.importKey(
                 'raw',
                 rawKey,
                 { name: 'AES-GCM' },
                 false,
                 ['encrypt', 'decrypt']
               );

               const encryptedFileBuffer = await crypto.subtle.encrypt(
                 { name: 'AES-GCM', iv: fileIV },
                 fileKey,
                 fileBuffer
               );

               const keyIV = crypto.getRandomValues(new Uint8Array(12));
               const encryptedFileKey = await crypto.subtle.encrypt(
                 { name: 'AES-GCM', iv: keyIV },
                 masterKey,
                 rawKey
               );

               const encryptedBlob = new Blob([encryptedFileBuffer], { type: file.type });
               const encryptedFile = new File([encryptedBlob], file.name, {
                 type: file.type,
                 lastModified: Date.now()
               });

               const toBase64 = (arrBuf) =>
                 btoa(String.fromCharCode(...new Uint8Array(arrBuf)));

               const formData = new FormData();
               formData.append('file', encryptedFile, encryptedFile.name);
               formData.append('file_iv', toBase64(fileIV));
               formData.append('enc_file_key', toBase64(encryptedFileKey));
               formData.append('key_iv', toBase64(keyIV));
               formData.append('salt', saltB64);

               try {
                 const res = await fetch('/frontend-encrypt', {
                   method: 'POST',
                   body: formData
                 });
                 const data = await res.json();
                 console.log('Server response:', data);
               } catch (error) {
                 console.error('Upload failed:', error);
               }

               console.log('Raw FileKey (base64):', toBase64(rawKey));
               console.log('File IV (base64):', toBase64(fileIV));
               console.log('Encrypted FileKey IV (base64):', toBase64(keyIV));
              

               message = `File "${file.name}" encrypted in your browser and uploaded securely!`;
                 await FileManager.loadFiles();

  // ‚úÖ Update dashboard stats immediately
  FileManager.updateDashboardStats();
             } 
             else {
               const finput = document.getElementById('fileInput');
               const file = finput.files[0];
               const formdata = new FormData();
               formdata.append('file', file);

               try {
                 const res = await fetch("encrypt-file", {
                   method: "POST",
                   body: formdata
                 });
                 const data = await res.json();
                 console.log(data);
               } catch (error) {
                 console.log(error);
               }
                 
               message = `File "${selectedFile.name}" uploaded and encrypted on the server successfully!`;
                await FileManager.loadFiles();

  // ‚úÖ Update dashboard stats immediately
  FileManager.updateDashboardStats();
             }
         }else{
           message="Incorrect Password"
         }

    statusMessage.textContent = message;
    statusMessage.classList.remove('info');
    statusMessage.classList.add('success');

    setTimeout(() => {
      fileInfo.classList.add('hidden');
      encryptionOptions.style.display = 'none';
      uploadBtn.style.display = 'none';
      statusMessage.classList.add('hidden');
      fileInput.value = '';
      selectedFile = null;
      resetEncryptionSelection();
    }, 4000);
  }
});



    let downloadf
    let selectedFile
 // File Management System
const FileManager = {
    currentFiles: [],
    currentFilter: 'all',
    currentSort: 'modified',
    sortDirection: 'desc',
    currentPage: 1,
    filesPerPage: 20,

    // Initialize file manager
    init() {
        this.loadFiles();
        this.setupEventListeners();
    },

    // Setup event listeners
    setupEventListeners() {
      

        // Pagination
        document.getElementById('prevPage').addEventListener('click', () => {
            if (this.currentPage > 1) {
                this.currentPage--;
                this.displayFiles();
            }
        });

        document.getElementById('nextPage').addEventListener('click', () => {
            const totalPages = Math.ceil(this.getFilteredFiles().length / this.filesPerPage);
            if (this.currentPage < totalPages) {
                this.currentPage++;
                this.displayFiles();
            }
        });
    },

    // Load files from backend
    async loadFiles() {
        try {
            // Show loading state
            
            
            // Fetch files from backend API
            const response = await fetch('/get-files', {
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json'
                }
            });
            
            if (!response.ok) {
                throw new Error('Failed to fetch files');
            }
            
            const backendFiles = await response.json();
            console.log('Files from backend:', backendFiles);
              if (!backendFiles || !Array.isArray(backendFiles) || backendFiles.length === 0) {
            console.warn("No files found");
            document.querySelector('.card p').textContent = '0';
            this.currentFiles = [];
            return;
        }
            
            // Transform backend data to match frontend format
            this.currentFiles = backendFiles.map(file => ({
                id: file.FileID.toString(),
                name: file.FileName,
                size: file.FileSize,
                type: this.detectFileType(file.FileName),
                modified: new Date().toISOString(),
                status: 'active',
                encryption: 'AES-256 Encrypted'
            }));
            
            // Save to localStorage as cache
            localStorage.setItem('userFiles', JSON.stringify(this.currentFiles));
            
            this.displayFiles();
            this.updateDashboardStats();
            
        } catch (error) {
            console.error('Error loading files:', error);
            // Try to load from localStorage as fallback
            const cachedFiles = localStorage.getItem('userFiles');
            if (cachedFiles) {
                this.currentFiles = JSON.parse(cachedFiles);
                this.displayFiles();
                this.updateDashboardStats();
            } else {
                this.currentFiles = [];
                this.showEmptyState();
            }
        }
    },

    // Display files in the table
    displayFiles() {
        const filesList = document.getElementById('filesList');
        const filteredFiles = this.getFilteredFiles();
        
        console.log('Total files:', this.currentFiles.length);
        // console.log('Filtered files:', filteredFiles.length);
        
        // Calculate pagination
        const startIndex = (this.currentPage - 1) * this.filesPerPage;
        const endIndex = startIndex + this.filesPerPage;
        const paginatedFiles = filteredFiles.slice(startIndex, endIndex);
        
        console.log('Paginated files:', paginatedFiles.length);
        
        // Check if we have any files at all
       
        
        // Force display with a tiny delay to ensure DOM updates
        setTimeout(() => {
            document.getElementById('filesTable').classList.remove('hidden');
            document.getElementById('filesPagination').classList.remove('hidden');
            
            // Generate file rows
            filesList.innerHTML = paginatedFiles.map(file => this.generateFileRow(file)).join('');
            
            // Update pagination controls
            // this.updatePagination(filteredFiles.length);
            
            // Update file count
            document.getElementById('filesCount').textContent = 
                `Showing ${startIndex + 1}-${Math.min(endIndex, filteredFiles.length)} of ${filteredFiles.length} files`;
                
            console.log('Table display updated');
        }, 10);
    },

    // Generate HTML for a file row
    generateFileRow(file) {
        const fileIcon = this.getFileIcon(file.type);
        const statusBadge = this.getStatusBadge(file.status);
        const formattedSize = this.formatFileSize(file.size);
        const formattedDate = this.formatDate(file.modified);
        
        return `
             <tr class="border-b border-[#233554] hover:bg-[#112240] file-item transition" data-file-id="${file.id}">
      <td class="py-3 px-4 flex items-center gap-3">
        <div class="w-8 h-8 bg-[#112240] rounded-lg flex items-center justify-center">
          ${fileIcon}
        </div>
        <div>
          <p class="font-medium">${file.name}</p>
          <p class="text-xs text-[#8892b0]">${file.encryption || 'AES-256 Encrypted'}</p>
        </div>
      </td>
      <td class="py-3 px-4">${formattedSize}</td>
      <td class="py-3 px-4">${this.getFileType(file.type)}</td>
      <td class="py-3 px-4">
        <div class="flex gap-2">
          <button class="text-[#64ffda] hover:text-[#5be8cc] file-action" data-action="download" data-file-id="${file.id}">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
            </svg>
          </button>
          <button class="text-[#ff6b6b] hover:text-[#ff5252] file-action" data-action="delete" data-file-id="${file.id}">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
            </svg>
          </button>
        </div>
      </td>
    </tr>
        `;
    },

    // Get file icon based on type
    getFileIcon(fileType) {
        const icons = {
            'pdf': 'üìÑ',
            'document': 'üìù',
            'image': 'üñºÔ∏è',
            'video': 'üé¨',
            'audio': 'üéµ',
            'archive': 'üì¶',
            'spreadsheet': 'üìä',
            'presentation': 'üìä'
        };
        
        return icons[fileType] || 'üìÑ';
    },

    // Get status badge HTML
    getStatusBadge(status) {
        const badges = {
            'active': '<span class="badge badge-active">Active</span>',
            'expired': '<span class="badge badge-expired">Expired</span>',
            'processing': '<span class="badge badge-processing">Processing</span>'
        };
        
        return badges[status] || '<span class="badge badge-active">Active</span>';
    },

    // Format file size
    formatFileSize(bytes) {
        if (bytes === 0) return '0 Bytes';
        const k = 1024;
        const sizes = ['Bytes', 'KB', 'MB', 'GB'];
        const i = Math.floor(Math.log(bytes) / Math.log(k));
        return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
    },

    // Format date
    formatDate(dateString) {
        const date = new Date(dateString);
        const now = new Date();
        const diffTime = Math.abs(now - date);
        const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
        
        if (diffDays === 1) return 'Yesterday';
        if (diffDays < 7) return `${diffDays} days ago`;
        if (diffDays < 30) return `${Math.floor(diffDays / 7)} weeks ago`;
        
        return date.toLocaleDateString();
    },

    // Get file type display name
    getFileType(fileType) {
        const types = {
            'pdf': 'PDF',
            'document': 'Document',
            'image': 'Image',
            'video': 'Video',
            'audio': 'Audio',
            'archive': 'Archive',
            'spreadsheet': 'Spreadsheet',
            'presentation': 'Presentation'
        };
        
        return types[fileType] || 'File';
    },

    // Filter files based on search and category
    filterFiles(searchTerm = '') {
        this.applyFilters(searchTerm);
    },

    // Apply all filters
    applyFilters(searchTerm = '') {
        this.currentPage = 1;
        this.displayFiles();
    },

    // Get filtered files
    getFilteredFiles() {
        let filtered = [...this.currentFiles];
        
        // Apply category filter
        if (this.currentFilter !== 'all') {
            filtered = filtered.filter(file => file.type === this.currentFilter);
        }
        
     
        // Apply sorting
        return this.sortFilesArray(filtered);
    },

    // Sort files array
    sortFilesArray(files) {
        return files.sort((a, b) => {
            let aValue = a[this.currentSort];
            let bValue = b[this.currentSort];
            
            if (this.currentSort === 'size') {
                aValue = parseInt(aValue);
                bValue = parseInt(bValue);
            } else if (this.currentSort === 'modified') {
                aValue = new Date(aValue);
                bValue = new Date(bValue);
            } else if (this.currentSort === 'name') {
                aValue = aValue.toLowerCase();
                bValue = bValue.toLowerCase();
            }
            
            if (this.sortDirection === 'asc') {
                return aValue > bValue ? 1 : -1;
            } else {
                return aValue < bValue ? 1 : -1;
            }
        });
    },

    // Sort files
    sortFiles() {
        this.displayFiles();
    },

    // Update sort icons
    updateSortIcons() {
        document.querySelectorAll('.sortable').forEach(header => {
            const icon = header.querySelector('.sort-icon');
            if (header.dataset.sort === this.currentSort) {
                icon.textContent = this.sortDirection === 'asc' ? '‚Üë' : '‚Üì';
            } else {
                icon.textContent = '‚Üï';
            }
        });
    },

    // Update pagination
    updatePagination(totalFiles) {
        const totalPages = Math.ceil(totalFiles / this.filesPerPage);
        const prevBtn = document.getElementById('prevPage');
        const nextBtn = document.getElementById('nextPage');
        
        prevBtn.disabled = this.currentPage === 1;
        nextBtn.disabled = this.currentPage === totalPages || totalPages === 0;
    },

   

    // Update dashboard statistics
updateDashboardStats() {
  const totalFiles = this.currentFiles.length;
  const totalSize = this.currentFiles.reduce((sum, file) => sum + file.size, 0);

  // Update total files count
  const filesCountElement = document.querySelector('.card p.text-3xl');
  if (filesCountElement) {
    filesCountElement.textContent = totalFiles;
  }

  // Update storage usage bar
  const storageElement = document.querySelector('.progress-fill');
  let storageUsed;
  if (storageElement) {
    storageUsed = (totalSize / (5 * 1024 * 1024 * 1024)) * 100;
    storageElement.style.width = `${Math.min(storageUsed, 100)}%`;
  }

  // Update storage text (was fixed at "5 GB")
   const storageTextElement = document.querySelector('.card span.text-sm');
  if (storageTextElement) {
    const usedGB = totalSize / (1024 * 1024 * 1024);
    storageTextElement.textContent = `${usedGB.toFixed(2)} GB`;
  }

  console.log("Total size (bytes):", totalSize);
  console.log("Storage used (%):", storageUsed);
}
,

    // Detect file type from filename
    detectFileType(filename) {
        const ext = filename.split('.').pop().toLowerCase();
        const typeMap = {
            'pdf': 'pdf',
            'doc': 'document', 'docx': 'document',
            'txt': 'document', 'rtf': 'document',
            'jpg': 'image', 'jpeg': 'image', 'png': 'image',
            'gif': 'image', 'bmp': 'image', 'svg': 'image',
            'mp4': 'video', 'avi': 'video', 'mov': 'video',
            'wmv': 'video', 'flv': 'video',
            'mp3': 'audio', 'wav': 'audio', 'ogg': 'audio',
            'flac': 'audio',
            'zip': 'archive', 'rar': 'archive', '7z': 'archive',
            'tar': 'archive',
            'xls': 'spreadsheet', 'xlsx': 'spreadsheet', 'csv': 'spreadsheet',
            'ppt': 'presentation', 'pptx': 'presentation'
        };
        
        return typeMap[ext] || 'document';
    },

    // Save files to localStorage
    saveFiles() {
        localStorage.setItem('userFiles', JSON.stringify(this.currentFiles));
    },

    // Handle file actions
    handleFileAction(fileId, action) {
        const file = this.currentFiles.find(f => f.id === fileId);
        if (!file) return;

        switch (action) {
            case 'view':
                this.viewFile(file);
                break;
            case 'download':
                this.downloadFile(file);
                break;
            case 'share':
                this.shareFile(file);
                break;
            case 'delete':
                this.deleteFile(file);
                break;
        }
    },

  

    // Download file
    async downloadFile(file) {
      console.log("test")
        downloadf = file;
  document.getElementById('decryptModal').classList.remove('hidden');
  document.getElementById('decryptModal').classList.add('flex');
    },
   
    

    // Delete file
    async deleteFile(file) {
        document.getElementById('confirmModal').classList.remove('hidden');
  document.getElementById('confirmModal').classList.add('flex')

  document.getElementById("confirm").addEventListener("click",async () =>{
      document.getElementById('confirmModal').classList.add('hidden');
       try {
              const response = await fetch(`/deletefile`, {
              method: 'DELETE',
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify({ id: parseInt(file.id) })
            });
                
                if (!response.ok) {
                    throw new Error('Failed to delete file');
                }
                
                this.currentFiles = this.currentFiles.filter(f => f.id !== file.id);
                this.saveFiles();
                this.displayFiles();
                this.updateDashboardStats();
                
            } catch (error) {
                console.error('Delete failed:', error);
                alert('Failed to delete file. Please try again.');
            }
  })
           
        
    }
};
 document.getElementById('cancelDecrypt').addEventListener('click', () => {
  document.getElementById('decryptModal').classList.add('hidden');
});


document.addEventListener('click', (event) => {
    const btn = event.target.closest('.file-action');
    if (!btn) return;

    const action = btn.dataset.action;
    const fileId = btn.dataset.fileId;

    if (action && fileId) {
       selectedFile = { id: fileId };
        FileManager.handleFileAction(fileId, action);
    }
});

document.getElementById('confirmDecrypt').addEventListener('click', async () => {
  const mode = document.getElementById('encryptionMode').value;
  const password = document.getElementById('decryptPassword').value.trim();

  if (!password) {
    document.getElementById('incorrectModal').classList.remove('hidden');
  document.getElementById('incorrectModal').classList.add('flex');
    return;
  }

  let backendreply
let formdata=new FormData()
  formdata.append("password",password)
         try{
             let response=await fetch("/Validatepass",{
              method:"POST",
              body:formdata
             })

             let data =await  response.text()
             reply=data
             console.log(data)
         }catch(error){
           console.log(error)
         }
  
         if(reply=="Pass"){
            
                    try {
                      if (mode === 'backend') {
                        // alert(selectedFile.id)
                        try{
                              let response=await fetch("/decrypt",{
                                method:"POST",
                                headers:{"content-type":"application/json"},
                                body:JSON.stringify({
                                    "FileID":parseInt(selectedFile.id),
                                    "Mode":mode
                                })
                              })
                              const disposition = response.headers.get("Content-Disposition");
                              let filename = "downloaded_file";

                              if (disposition && disposition.includes("filename=")) {
                                const match = disposition.match(/filename="([^"]+)"/);
                                if (match && match[1]) {
                                  filename = match[1];
                                }
                              }
                              const blob = await response.blob();

                                const url = window.URL.createObjectURL(blob);
                                const a = document.createElement('a');
                                a.href = url;
                                a.download = filename
                                document.body.appendChild(a);
                                a.click();
                                document.body.removeChild(a);
                                window.URL.revokeObjectURL(url);

                                // üü© Close modal
                                document.getElementById('decryptModal').classList.add('hidden');
                                document.getElementById('decryptPassword').value = ''; // clear password
                          }catch(error){
                            console.log(error)
                          }

                       

                        // const blob = await response.blob();
                        // triggerDownload(blob, selectedFile.name);
                        // alert(1)

                      } else {
                        console.log("HEH")
                           function base64ToUint8Array(b64) {
                            b64 = b64.replace(/-/g, "+").replace(/_/g, "/");
                            while (b64.length % 4 !== 0) b64 += "=";
                            const binary = atob(b64);
                            const bytes = new Uint8Array(binary.length);
                            for (let i = 0; i < binary.length; i++) bytes[i] = binary.charCodeAt(i);
                            return bytes;
                          }


                            function hexToUint8Array(hex) {
                              const arr = new Uint8Array(hex.length / 2);
                              for (let i = 0; i < arr.length; i++) arr[i] = parseInt(hex.substr(i * 2, 2), 16);
                              return arr;
                            }

                            function decodeSalt(s) {
                              if (!s) return new Uint8Array();
                              const hexRegex = /^[0-9a-fA-F]+$/;
                              if (hexRegex.test(s) && s.length % 2 === 0) return hexToUint8Array(s);
                              try {
                                return base64ToUint8Array(s);
                              } catch (e) {
                                return new TextEncoder().encode(s);
                              }
                            }



                            // ---------- Main decryption function ----------
                           
                              try {
                                
                                const response = await fetch("/decrypt", {
                                  method: "POST",
                                  headers: { "Content-Type": "application/json" },
                                  body: JSON.stringify({
                                    FileID: parseInt(selectedFile.id),
                                    Mode: mode,
                                  }),
                                });

                                if (!response.ok) throw new Error("Failed to fetch file info from server");

                                const data = await response.json();
                                console.log("Received from backend:", data);

                                const ciphertext = base64ToUint8Array(data.CipherText);
                                const fileIV = base64ToUint8Array(data.FileIV);
                                const encFileKey = base64ToUint8Array(data.EncFileKey);
                                const encFileKeyIv = base64ToUint8Array(data.EncFileIv);
                                const saltBytes = decodeSalt(data.Salt);
                                const filename = data.FileName || "decrypted_file";

                                const pwBytes = new TextEncoder().encode(password);
                                const baseKey = await crypto.subtle.importKey(
                                  "raw",
                                  pwBytes,
                                  { name: "PBKDF2" },
                                  false,
                                  ["deriveKey"]
                                );

                                const iterations = 200000; // must match backend
                                const masterKey = await crypto.subtle.deriveKey(
                                  {
                                    name: "PBKDF2",
                                    salt: saltBytes,
                                    iterations,
                                    hash: "SHA-256",
                                  },
                                  baseKey,
                                  { name: "AES-GCM", length: 256 },
                                  false,
                                  ["decrypt"]
                                );

                                const rawFileKey = await crypto.subtle.decrypt(
                                  { name: "AES-GCM", iv: encFileKeyIv },
                                  masterKey,
                                  encFileKey
                                );

                                const fileKey = await crypto.subtle.importKey(
                                  "raw",
                                  rawFileKey,
                                  { name: "AES-GCM" },
                                  false,
                                  ["decrypt"]
                                );

                                const decryptedBuffer = await crypto.subtle.decrypt(
                                  { name: "AES-GCM", iv: fileIV },
                                  fileKey,
                                  ciphertext
                                );

                                const blob = new Blob([decryptedBuffer], { type: "application/octet-stream" });
                                const url = URL.createObjectURL(blob);

                                const a = document.createElement("a");
                                a.href = url;
                                a.download = filename;
                                document.body.appendChild(a);
                                a.click();
                                document.body.removeChild(a);
                                URL.revokeObjectURL(url);

                                console.log("‚úÖ Decryption successful, file downloaded:", filename);
                              } catch (err) {
                                console.error("‚ùå Frontend decryption failed:", err);
                                alert(err.message || "Decryption failed ‚Äî check console for details.");
                              }
                            

                      }

                      document.getElementById('decryptModal').classList.add('hidden');
                    } catch (err) {
                      console.error('Decryption/Download failed:', err);
                      alert('Failed to decrypt or download file.');
                    }
         }else{
          console.log("Incorrect Password")
             document.getElementById('incorrectModal').classList.remove('hidden');
  document.getElementById('incorrectModal').classList.add('flex');
    return;
         }

});

document.getElementById("logout").addEventListener("click" ,async() =>{
  try{
   let response =  await fetch("/logout",{
      method:"POST",
      credentials:"include"
    })
    // window.location.replace("index.html")
      if (response.redirected) {
      window.location.replace(response.url);
    }
  }catch(error){
    console.log(error)
  }
} )

// Download helper
function triggerDownload(blob) {
  const url = window.URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = filename;
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  window.URL.revokeObjectURL(url);
}


// Initialize file manager when dashboard loads
document.addEventListener('DOMContentLoaded', function() {
    FileManager.init();
    
    // Add event delegation for file actions
    document.getElementById('filesList').addEventListener('click', (e) => {
        const actionBtn = e.target.closest('.file-action');
        if (actionBtn) {
            const fileId = actionBtn.dataset.fileId;
            const action = actionBtn.dataset.action;
            FileManager.handleFileAction(fileId, action);
        }
    });
    
    // Function to show upload section
   
});
 window.showUploadSection = function() {
      console.log("Switching to Upload section...");
        document.querySelectorAll('.sidebar-item').forEach(item => item.classList.remove('active'));
        document.querySelectorAll('.content-section').forEach(section => section.classList.remove('active'));
        
        document.querySelector('[data-target="upload"]').classList.add('active');
        document.getElementById('upload').classList.add('active');
        document.getElementById('page-title').textContent = 'Upload Files';
    };

    document.getElementById("Delete").addEventListener("click", () =>{
         document.getElementById('deleteModal').classList.remove('hidden');
  document.getElementById('deleteModal').classList.add('flex');
    })

     document.getElementById('cancelDelete').addEventListener('click', () => {
  document.getElementById('deleteModal').classList.add('hidden');
});
 document.getElementById('OK').addEventListener('click', () => {
  document.getElementById('incorrectModal').classList.add('hidden');
});
 document.getElementById('back').addEventListener('click', () => {
  document.getElementById('accdeletedModal').classList.add('hidden');
  window.location.replace("/index.html")
});

 document.getElementById('confirmDelete').addEventListener('click',async () => {
    let password=document.getElementById("deletePassword").value
    let formdata=new FormData()
    let res
    formdata.append("password",password)
    
        try{
          let r = await fetch("/deleteacc",{
            method:"DELETE",
            body:formdata,
            credentials:"include"
          })
          let data=await r.json()
          console.log(data)

          if(!data.Valid){
            window.location.replace("/index.html")
            return
          }

          if(!data.Ok){
           document.getElementById('deleteModal').classList.add('hidden');
              document.getElementById('incorrectModal').classList.remove('hidden');
  document.getElementById('incorrectModal').classList.add('flex');
            return
          }

          if(data.Ok && data.Status=="Deleted"){
           document.getElementById('deleteModal').classList.add('hidden');
              document.getElementById('accdeletedModal').classList.remove('hidden');
  document.getElementById('accdeletedModal').classList.add('flex');
          }
         
          

        }catch(Error){
          console.log(Error)
        }

      
       


});
</script>

</body>
</html>